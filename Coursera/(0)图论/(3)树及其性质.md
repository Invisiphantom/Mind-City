

树的定义(Tree)
连通 无回路 的图，称为树
树中度数为1的顶点称为树叶，其余顶点称为内点
不相交的树的全体称为森林

树的等价定义
1. 无回路的连通图
2. 无回路图，并且e=n-1
3. 连通图，并且e=n-1
4. 最大无回路图
5. 最小连通图
6. 每对顶点间只有唯一路

$1\to2$
无回路的连通图$\to$无回路图,并且e=n-1
对顶点数n进行归纳证明：
当n=1时，e=0,满足条件
假设当n-1时结论成立，现证明当n时结论也成立
因为如果所有顶点的度数至少为2,那么会存在一条回路
又因为是连通图,所以顶点度数不为0
所以至少存在一个度数为1的顶点v，将v及其关联边删去，得到图G'
由归纳假设知,图G'是无回路图,并且e'=n'-1
然后再将顶点v和关联边加回来,得到e=n-1,得证


$2\to3$
无回路图,并且e=n-1$\to$连通图，并且e=n-1
用反证法证明:假设T不连通,那么T就有多个连通分支
设为$T_1,\cdots,T_k(k\ge2)$,
顶点数分别为$n_1,\cdots,n_k$，边数分别为$e_1,\cdots,e_k$
因为是无回路图，所以每个连通分支都是无回路连通图
所以$e_i=n_i-1(i=1,\cdots,k)$
故$e=\sum e_i=\sum(n_i-1)=n-k\neq n-1$，得出矛盾


$3\to4$
连通图，并且e=n-1$\to$最大无回路图
对顶点数n进行归纳证明 T是无回路图：
当n=2时，e=1,满足条件
假设当n-1时结论成立，现证明当n时结论也成立
如果每个顶点的度数至少为2，那么就会有e>=n，不成立
所以至少有一个顶点v，使得d(v)=1，将v及其关联边删去，得到图T'
因为T'满足e'=n'-1，所以T'是无回路图
再将顶点v加回T'得到T，此时T也会是无回路图
再证明T是**最大的**无回路图：
因为T是连通图，所以T中任意两个顶点都存在路相连
此时加上任意一条边(u,v)，都会导致u->v有多条路，所以会有回路
故T是最大的无回路图



$4\to5$
最大无回路图$\to$最小连通图
用反证法证明T是连通图：
假设T不是连通图，既存在u和v之间没有路
那么此时加上(u,v)不会导致回路的产生
所以T就不是**最大的**无回路图，得出矛盾
再证明T是**最小的**连通图：
由于T中没有回路，所以删去任意一条边(u,v)，
都会导致u和v之间没有其他路，u和v不连通
所以T是最小的连通图


$5\to6$
最小连通图$\to$每对顶点间只有唯一路
用反证法证明：
因为T是连通图，所以每对顶点之间都至少有1条路
假设有一对顶点之间存在多条路，那么T中存在回路
那么删去回路中的一条边，图仍然连通，
说明T不会是**最小的**连通图，得出矛盾


$6\to1$
每对顶点间只有唯一路$\to$无回路的连通图
用反证法证明：因为每对顶点间有路，所以T是连通图
假设T是有回路的，那么存在两个顶点，它们间存在多重路
得出矛盾



推论
若G是n个顶点，k个连通分支的森林，那么G会有n-k条边
证明:G的多个连通分支设为$T_1,\cdots,T_k(k\ge2)$,
顶点数分别为$n_1,\cdots,n_k$，边数分别为$e_1,\cdots,e_k$
因为每个分支都是树，所以$e_i=n_i-1(i=1,\cdots,k)$
故$e=\sum e_i=\sum(n_i-1)=n-k\neq n-1$，得证


在任意一棵顶点数n(n>=2)的树T中，至少有两片树叶
用反证法证明：假设至多有一个顶点度数为1，其他顶点度数均>=2
那么$\sum d(v_i)\ge2(n-1)+1=2n-1\neq2e=2(n-1)=2n-2$，得出矛盾

------


生成树的定义(Generting Tree)
(取出所有顶点，但只取出部分边)
图G的生成子图是树T，称树T为图G的生成树
将G-T得到的图称为G的余枝，记为$\overline{T}$
T中的边称为树枝，$\overline{T}$中的边称为弦

G是连通图，当且仅当G有生成树
$\impliedby$:因为生成树是连通图，所以G也是连通图
$\implies$:采用构造法证明：
设G是连通图，如果G没有回路，那么G就是生成树
如果G存在回路，那就从这条回路中删去一条边，
不断重复，直到得到一棵生成树


秩、零度的定义
设图G有n个顶点，e条边，$\omega$个分支，
称n-$\omega$为图G的秩，$e-n+\omega$为图G的零度



割集
若在图G中删去D的全部边后所得图的秩减少1，
也就是图G的连通度增加1，
而D的任何真子集均无此性质，
则称D为G的割集



断集(边割)
设图G顶点的非空子集$V_0\subset V$，
则将图G中，一个顶点在$V_0$中，
而另一个顶点在$\overline{V_0}$中的边的集合称为G的一个断集(边割)
记为$E(V_0,\overline{V_0})$，简记为$(V_0,\overline{V_0})$
如果$|(V_0,\overline{V_0})|=1$，那么$(V_0,\overline{V_0})$中的那条边就是割边(桥)


割集是断集，但是断集不一定是割集
因为断集可能会导致图G的连通度增加>=2


回路和生成树的余树有公共边
反证法证明：假设回路和生成树的余树没有公共边
那么回路就会出现在生成树中，这与树的定义矛盾


割集和生成树有公共边
反证法证明：假设割集和生成树没有公共边
那么删去一条割集后，生成树仍然连通
也就是说，删去割集不能使得图G分为两个分支，
这与割集的定义相矛盾


回路和割集有偶数条公共边
证明：从连通图G中删去一个割集D后，得到彼此不相交的两个分支$V_1$和$V_2$
对于任意一条回路C，有以下两种情况：
1. 如果C中所有顶点都在$V_1$或者$V_2$中，那么C和D没有公共边
2. 如果C中的顶点既有在$V_1$中的，又有在$V_2$中的，
假设回路从$V_1$出发，那么回路会在$V_1$和$V_2$之间来回走，
因为最终回路还是要回到$V_1$，所以回路会经过D中的偶数条边



基本割集的定义
设连通图G中有生成树T，对于只包含T中一条枝的割集，
称此割集为关于T的基本割集
因为生成树共有n-1条枝，所以基本割集共有n-1个
这些割集的全体称为图G关于T的基本割集组


基本回路的定义
设连通图G中有生成树T，对于只包含T中一条弦的回路，
也就是在T中加上一条弦，恰产生的那条回路，
称此回路为关于T的基本回路
因为生成树共有n-1条枝，所以余树有e-(n-1)=e-n+1条弦
所以基本回路共有e-n+1个
这些回路的全体称为图G关于T的基本回路组


树的基本变换的定义
设连通图G中有生成树T，$\overline{e}$是任意一弦，
则$T\cup\overline{e}$恰产生一条基本回路C，
e是C上的任意一枝，则$(T\cup\overline{e})-e$仍然是一棵生成树
称这种变换为树的基本变换


树的距离的定义
设连通图G有生成树$T_i$和$T_j$，
$|T_i-T_j|$称为树$T_i$和$T_j$的距离，记为$d(T_i,T_j)$
即出现在$T_i$，而不出现在$T_j$中的枝的条数


设连通图G有不同的生成树$T_1$和$T_2$，
则由$T_1$经过有限次树的基本变换后，可以得到$T_2$
用构造法证明：因为$T_1\neq T_2$，所以$d(T_1,T_2)>0$
取独属于$T_2$的一条枝$e_2$加入$T_1$中，
使得$T_1\cup e_2$恰产生一条基本回路C
因为$T_2$也是一棵树，所以基本回路中存在$e_1$，
使得$e_1\in T_1,e_1\notin T_2$，
则$T_1'=T_1\cup e_2-e_1$仍然是一棵生成树，
并且$d(T_1',T_2)<d(T_1,T_2)$
重复上述过程，经过有限步k后，可以得到$d(T_1^{(k)},T_2)=0$
此时即可得到$T_1^{(k)}=T_2$


<br><br>


最小生成树的定义
设$G(V,E,f)$是带权连通简单图，f是边的权值函数，
设T是G的一棵生成树，T中所有枝的权值之和称为T的权值，
记为$W(T)=\sum_{e\in T}f(e)$
具有$\min W(T)$性质的生成树T称为G的最小生成树


Kruskal算法
设$G(V,E,f)$是具有n个顶点的带权连通简单图
1. 从G中选出最小边$e_1$，加入到T中
2. 从G-T中选出最小边$e_i$
      1. 如果$T\cup\{e_i\}$不产生回路，那么将$e_i$加入到T中
      2. 如果$T\cup\{e_i\}$产生回路，那么将$e_i$舍弃


Kruskal算法得到的图T是最小生成树
用反证法证明：假设T不是G的最小生成树，
而S才是最小生成树，即$W(S)<W(T)$
将生成树T中的n-1条边，按权值从小到大排列为$e_1,\cdots,e_k,\cdots,e_{n-1}$
因为$T\neq S$，所有存在某个k，
使得$e_k\in T,e_k\notin S$，并且$e_1,\cdots,e_{k-1}\in S\cap T$
将S加上$e_k$得到基本回路C，C中肯定有一边e'独属于S
假如$f(e')<f(e_k)$，那么当初在用Kruskal算法时，就会选择e'而不是e_k
所以$f(e')\ge f(e_k)$，所以$W(S\cup e_k)-e'\ge W(S)$
重复上述的基本变换，经过有限步k后，可以得到$S^{(k)}=T$，而$W(S^{(k)})\ge W(T)$
与之前的假设$W(S)<W(T)$不符，所以得出矛盾



<br><br>


Cayley定理
标定完全图$K_n(n\ge2)$的不同生成树总数$L(n)=n^{n-2}$
采用构造法证明：
在标定图$K_N$的不同生成树中，对于其中标号为v的顶点
其度数$d(v)$肯定为1,2,...,n-1的其中之一
设当顶点v度数为k时，生成树的总数为$L(n,k)$
故$L(n)=\sum_{k=1}^{n-1}L(n,k)$

下面开始计算$L(n,k)$：

记生成树S对顶点v的 增度 操作为：
设S是使得顶点v度数为k-1的任意生成树
从S中删去与顶点v不相关的任意边{u,w}
得到两棵子树U和W，不妨设v在子树U中
则此时连接{v,w}可以得到生成树T，
且在生成树T中，顶点v的度数增至k

由于生成树S的总边数为n-1
与顶点v相关的边数为k-1
所以与顶点v不相关的边数有n-1-(k-1)=n-k条
又因为使得顶点v度数为k-1的生成树S共有$L(n,k-1)$种
故生成树S对顶点v的增度操作共有$(n-k)L(n,k-1)$种

记生成树T对顶点v的 减度 操作为：
设T是使得顶点v度数为k的任意生成树
如果从T中删去v，则会得到子树$T_1,T_2\cdots,T_k$
现在从T中删去关联边$\{v,w_i\}$，其中$w_i$在$T_i$中
然后再连接$w_i$和u，其中u在$T_j(i\neq j)$中
这样便得到生成树S，且在生成树S中，顶点v的度数减至k-1

对于选取关联边，有$w_1,w_2\cdots,w_k$共k种选法
选取了$w_i$之后，由于$\sum_{i\neq j} T_j=n-1-n_i$
所以对于u共有$n-1-n_i$种选法
又因为使得顶点v度数为k的生成树T共有$L(n,k)$种
故生成树T对顶点v的减度操作共有
$
[(n-1-n_i)+\cdots+(n-1-n_k)]\ L(n,k)= \\
[k(n-1)-(n_1+n_2+\cdots+n_k)]\ L(n,k)= \\
[k(n-1)-(n-1)]\ L(n,k)= \\
(n-1)(k-1)L(n,k)
$

由于增度和减度操作是一一对应的
并且生成树S对顶点v的增度操作共有$(n-k)L(n,k-1)$种
生成树T对顶点v的减度操作共有$(n-1)(k-1)L(n,k)$种
所以有$(n-k)L(n,k-1)=(n-1)(k-1)L(n,k)$
即$L(n,k)=\frac{n-1}{n-k-1}L(n,k-1)=(n-1)^{n-k-1}C(n-2,k-1)$
所以标定完全图$K_n(n\ge2)$的不同生成树总数$L(n)=\sum_{k=1}^{n-1}L(n,k)=n^{n-2}$

<br><br>

有向树的定义
如果该有向图在不考虑弧方向时是一棵树，则称该有向图为有向树

有根树的定义
若一棵有向树恰有一个顶点的入度为0，其余所有顶点的入度为1，则称该有向树为有根树
入度为0的顶点称为根，出度不为0的点称为分枝点，出度为0的点称为树叶

子树的定义
由顶点a及其所有后代导出的子图，称为以顶点a为根的子树

层数的定义
有根树中，从根到顶点a的路径长度称为顶点a的层数
有根树中的最大层数称为有根树的高

有序树的定义
有根树的每个分枝点连出的弧，从左到右用$1,2,\cdots,k$标号，
则称该有根树为有序树

m分树和正则m分树的定义
若树T中每个顶点的出度小于等于m，则称T为m分树
若每个顶点的出度等于m或者等于0，则称T为正则m分树

在正则二分树中，分枝点数为i，树叶数为t，则有t=i+1
证明：因为有i个分枝点，而每个分枝点都有儿子
故有2i个儿子，再加上根结点就有2i+1个顶点
又因为所有顶点，要么是树叶，要么是分枝点
故有 总顶点数=树叶数+分枝点数=t+i
则 总顶点数=2i+1=t+i，即t=i+1，得证

在正则m分树中，树叶数为t，分枝点数为i，则有t=(m-1)i+1
证明同上

在正则二分树T中，所有分枝点的层数总和为I，树叶的层数总和为E，则有E=I+2i
对分枝点数i进行证明：当i=1时，E=2，I=0，满足条件
假设i=k-1时结论成立，现证明当i=k时结论也成立
删去正则二分树T中一个分枝点v的两个儿子，得到树T'
其中不妨设分枝点v的层数为l
因为树T'也是正则二分树，则有E'=I'+2(k-1)=I'-2+2k，即E'+2=I'+2k
然后再把v的两个儿子加回来，得到树T
此时T'的树叶顶点中失去了v，但是得到了它的两个儿子
所以E=E'-l+2(l+1)=E'+l+2
而T'的分枝顶点中多出了v，所以I=I'+l
将E和I带入上面的公式中得到E-l=E'+2=I'+2k=I-l+2k
化简得到E=I+2k，得证

在正则m分树T中，所有分枝点的层数总和为I，树叶的层数总和为E，则有E=(m-1)I+mi
证明同上

<br><br>

前缀码的定义
二进制有限序列组成的集合称为码，其中的每个元素称为码字
如果任意码字都不是其他码字的前缀，则称该码为前缀码

给定一棵二分树，则可确定一个前缀码
反之，对应于一个前缀码，存在一棵二分树

最优树的定义
给定一组权重$w_1,w_2,\cdots,w_n$且$w_1\le w_2\le\cdots\le w_n$
将这组权重对应的带权二分树记为T，则T的权重$W(T)=\sum_{i=1}^nw_il_i$
其中$l_i$为顶点i的层数，称为带权$w_i$的顶点i的路径长度
在所有带权$w_1,w_2,\cdots,w_n$的二分树中，
使得权重W(T)最小的二分树称为最优二分树，简称最优树

引理
对于最优树T每层的结点，其上层结点的权重比它大，其下层结点的权重比它小
用反证法证明：假如上层结点权重比它小，则将上层结点和它交换，得到的树权重会减小，与最优树矛盾
假如下层结点权重比它大，则将下层结点和它交换，得到的树权重会减小，与最优树矛盾


引理
最优树T中最小的两个权重，是在最底层的两个兄弟叶子结点
用反证法证明：假设v是最底层的分支点，其子结点必为两个叶子结点
因为假设若子结点只有一个叶子结点，则可以用该叶子结点替换分支点
假如这两个叶子结点不是最小权重，
那么把最小的和这两个点交换能使得W(T)减小，这与T是最优树矛盾
所以最小的两个权重，是在最底层的两个兄弟叶子结点


引理
最优树T的结点，收缩和展开后得到的T'仍然是最优树
用构造法证明：
设n个结点的最优树$T_n$，将$V_{w_1},V_{w_2}$收缩得到$T_{n-1}'$
则$W(T_n)=W(T_{n-1}')+(w_1+w_2)$ ----(1)
设n-1个结点的最优树$T_{n-1}$，将$V_{w_1+w_2}$展开得到$T_n'$
则$W(T_{n-1})=W(T_n')-(w_1+w_2)$ ----(2)
将 (1)式+(2)式 得$W(T_n)+W(T_{n-1})=W(T_{n-1}')+W(T_n')$
又因为$T_n$和$T_{n-1}$都是最优树，
所以$W(T_n)\le W(T_n')$，$W(T_{n-1})\le W(T_{n-1}')$
要使得$W(T_n)+W(T_{n-1})=W(T_{n-1}')+W(T_n')$
则必然要满足$W(T_n)=W(T_n')$，$W(T_{n-1})=W(T_{n-1}')$
故$T_n'$和$T_{n-1}'$也是最优树，得证



霍夫曼算法
对于n个权重$w_1,w_2,\cdots,w_n$且$w_1\le w_2\le\cdots\le w_n$
首先构造n棵只有一个结点的二分树，每棵树的权重为$w_1,w_2,\cdots,w_n$
1. 选择两棵权重最小的二分树，将它们收缩为一个结点，权重为这两棵树的权重之和
2. 重复步骤1，直到只剩下一棵二分树，这棵二分树就是霍夫曼树


霍夫曼算法得到的霍夫曼树，是最优树
对权重个数n进行归纳证明：
假设对于n-1个权重，霍夫曼树是最优树，现证明对于n个权重，霍夫曼树也是最优树
对于具有n个权重的霍夫曼树$T_n$，设最小的两个权重为$w_1,w_2$
由引理可知，$w_1,w_2$是在最底层的两个兄弟叶子结点
将$w_1,w_2$收缩为一个结点，得到$T_{n-1}$
由霍夫曼算法的构造过程可知，$T_{n-1}$是具有n-1个权重霍夫曼树
因为$T_{n-1}$是具有n-1个权重霍夫曼树，由归纳假设可知，$T_{n-1}$是最优树
然后再将$T_{n-1}$中的$w_1,w_2$展开，重新得到$T_n$
因为$T_{n-1}$是最优树，由引理可知，其展开后的$T_n$也是最优树，得证
